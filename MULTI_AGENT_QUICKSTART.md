# å¤šAgentåä½œç³»ç»Ÿ - å¿«é€Ÿå¼€å§‹

## ðŸš€ å¿«é€Ÿå¼€å§‹

### 1. çŽ¯å¢ƒé…ç½®

ç¡®ä¿ä½ çš„ `.env` æ–‡ä»¶åŒ…å«ç«å±±å¼•æ“ŽAPIé…ç½®ï¼š

```env
# ç«å±±å¼•æ“ŽAPIé…ç½®ï¼ˆå¿…éœ€ï¼‰
ARK_API_KEY=your_api_key_here
ARK_API_URL=https://ark.cn-beijing.volces.com/api/v3/chat/completions
ARK_MODEL=doubao-1-5-thinking-pro-250415

# Embeddingæ¨¡åž‹é…ç½®ï¼ˆç”¨äºŽç›¸ä¼¼åº¦è®¡ç®—ï¼Œå¯é€‰ï¼‰
# å¦‚æžœä¸é…ç½®æˆ–é…ç½®é”™è¯¯ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨é™çº§åˆ°ç®€å•æ–‡æœ¬ç›¸ä¼¼åº¦
ARK_EMBEDDING_API_URL=https://ark.cn-beijing.volces.com/api/v3/embeddings
ARK_EMBEDDING_MODEL=doubao-embedding-text-240715  # æˆ–ä½¿ç”¨ ep-xxxxx (endpoint ID)
```

**æ³¨æ„**ï¼š
- Embeddingé…ç½®æ˜¯**å¯é€‰çš„**ï¼Œå¦‚æžœä¸é…ç½®ç³»ç»Ÿä¼šè‡ªåŠ¨ä½¿ç”¨ç®€å•ç›¸ä¼¼åº¦
- å…³äºŽembeddingçš„è¯¦ç»†é…ç½®æ–¹æ³•ï¼Œè¯·å‚è€ƒ [Embeddingé…ç½®æŒ‡å—](./docs/EMBEDDING_SETUP_GUIDE.md)
- å¦‚æžœçœ‹åˆ° "doubao-embedding does not exist" é”™è¯¯ï¼Œè¯´æ˜Žéœ€è¦åœ¨ç«å±±å¼•æ“ŽæŽ§åˆ¶å°åˆ›å»ºendpoint

### 2. å®‰è£…ä¾èµ–

```bash
npm install
```

### 3. å¯åŠ¨åº”ç”¨

```bash
# å¼€å‘æ¨¡å¼
npm run dev

# æˆ–è€…ç”Ÿäº§æ¨¡å¼
npm run build
npm run serve
```

### 4. ä½¿ç”¨å¤šAgentæ¨¡å¼

1. æ‰“å¼€æµè§ˆå™¨è®¿é—® `http://localhost:8080`
2. åœ¨èŠå¤©ç•Œé¢é¡¶éƒ¨æ‰¾åˆ°æ¨¡å¼åˆ‡æ¢æŒ‰é’®
3. ç‚¹å‡» **"ðŸ§  Smart AI"** æŒ‰é’®åˆ‡æ¢åˆ°å¤šAgentæ¨¡å¼
4. è¾“å…¥ä½ çš„è§„åˆ’éœ€æ±‚ï¼Œä¾‹å¦‚ï¼š
   ```
   å¸®æˆ‘åˆ¶å®šä¸€ä¸ª3ä¸ªæœˆçš„IELTSå¤‡è€ƒè®¡åˆ’ï¼Œç›®æ ‡æ˜¯è¾¾åˆ°7åˆ†
   ```
5. è§‚å¯Ÿå¤šAgentåä½œè¿‡ç¨‹ï¼š
   - ðŸ“‹ **Planner** ç”Ÿæˆåˆæ­¥è®¡åˆ’
   - ðŸ” **Critic** æå‡ºæ‰¹è¯„å’Œå»ºè®®
   - ðŸŽ¯ **Host** åˆ†æžå…±è¯†å¹¶å†³ç­–ä¸‹ä¸€æ­¥
   - ðŸ“ **Reporter** ç”Ÿæˆæœ€ç»ˆæŠ¥å‘Š

## ðŸŽ¯ ç³»ç»Ÿç‰¹æ€§

### 4ä¸ªAgentè§’è‰²

- **ðŸ“‹ Plannerï¼ˆè§„åˆ’å¸ˆï¼‰**: æ‹†è§£ç›®æ ‡ï¼Œç”Ÿæˆç»“æž„åŒ–è®¡åˆ’
- **ðŸ” Criticï¼ˆæ‰¹è¯„å®¶ï¼‰**: æŒ‘åˆºã€é£Žé™©è¯„ä¼°ã€æå‡ºæ”¹è¿›å»ºè®®
- **ðŸŽ¯ Hostï¼ˆä¸»æŒäººï¼‰**: æµç¨‹æŽ§åˆ¶ã€å…±è¯†æ£€æµ‹ã€å†³ç­–ç®¡ç†
- **ðŸ“ Reporterï¼ˆæŠ¥å‘Šå‘˜ï¼‰**: ç”Ÿæˆæœ€ç»ˆæŠ¥å‘Šå’Œæ€»ç»“

### æ™ºèƒ½å†³ç­–æœºåˆ¶

- **å…±è¯†æ£€æµ‹**: 
  - ä¼˜å…ˆä½¿ç”¨embeddingå‘é‡ï¼ˆç«å±±å¼•æ“Ždoubao-embeddingæ¨¡åž‹ï¼‰è®¡ç®—ç«‹åœºç›¸ä¼¼åº¦
  - é€šè¿‡ä½™å¼¦ç›¸ä¼¼åº¦ï¼ˆCosine Similarityï¼‰ç²¾ç¡®æµ‹é‡Agentç«‹åœºçš„ä¸€è‡´æ€§
  - å¦‚æžœembedding APIä¸å¯ç”¨ï¼Œè‡ªåŠ¨é™çº§åˆ°ç®€å•æ–‡æœ¬ç›¸ä¼¼åº¦ï¼ˆJaccardç›¸ä¼¼åº¦ï¼‰
  - ç”Ÿæˆç›¸ä¼¼åº¦çŸ©é˜µï¼Œè¯†åˆ«æœ€ä¸ç›¸ä¼¼çš„Agenté…å¯¹
- **é¡½å›ºæ£€æµ‹**: 
  - è®¡ç®—Agentå‰åŽè½®çš„è‡ªç›¸ä¼¼åº¦ï¼Œè¯†åˆ«ä¸æ„¿æ”¹å˜ç«‹åœºçš„Agent
  - è¿žç»­2è½®è‡ªç›¸ä¼¼åº¦ > 0.98 æ—¶è§¦å‘é¡½å›ºè­¦å‘Š
  - Hostä¼šè¦æ±‚é¡½å›ºAgentä¿®æ”¹å‡è®¾æˆ–é™ä½Žç½®ä¿¡åº¦
- **åŠ¨æ€è°ƒæ•´**: æ ¹æ®è®¨è®ºè¿›å±•è‡ªåŠ¨è°ƒæ•´ç­–ç•¥
  - å…±è¯† > 0.90 â†’ è¿›å…¥æ”¶æ•›é˜¶æ®µ
  - 0.70 < å…±è¯† â‰¤ 0.90 â†’ ç»§ç»­è®¨è®º
  - å…±è¯† â‰¤ 0.70 â†’ å¼ºåˆ¶åæ–¹è§’è‰²
- **è½®æ¬¡æŽ§åˆ¶**: æœ€å¤š5è½®è®¨è®ºï¼Œé˜²æ­¢æ— é™å¾ªçŽ¯

### å®žæ—¶å¯è§†åŒ–

- åˆ†è½®å±•ç¤ºå„Agentçš„è¾“å‡º
- å…±è¯†è¶‹åŠ¿å›¾
- Hostå†³ç­–è¿‡ç¨‹
- æœ€ç»ˆæŠ¥å‘Šé«˜äº®

## ðŸ“‹ ç¤ºä¾‹åœºæ™¯

### åœºæ™¯1ï¼šå­¦ä¹ è§„åˆ’

**è¾“å…¥**ï¼š
```
æˆ‘æƒ³å­¦ä¹ Reactï¼Œå¸®æˆ‘åˆ¶å®šä¸€ä¸ª2ä¸ªæœˆçš„å­¦ä¹ è®¡åˆ’
```

**é¢„æœŸè¾“å‡º**ï¼š
- Planner: åˆ†é˜¶æ®µå­¦ä¹ è·¯çº¿ï¼ˆåŸºç¡€ â†’ è¿›é˜¶ â†’ å®žæˆ˜ï¼‰
- Critic: æŒ‡å‡ºæ—¶é—´åˆ†é…é—®é¢˜ã€å»ºè®®å¢žåŠ å®žæˆ˜é¡¹ç›®
- Host: æ£€æµ‹åˆ°ä¸­ç­‰å…±è¯†ï¼Œç»§ç»­è®¨è®º
- Planner: è°ƒæ•´è®¡åˆ’ï¼Œå¢žåŠ é¡¹ç›®å®žæˆ˜
- Reporter: ç”Ÿæˆæœ€ç»ˆå­¦ä¹ è®¡åˆ’

### åœºæ™¯2ï¼šå¥èº«è®¡åˆ’

**è¾“å…¥**ï¼š
```
åˆ¶å®šä¸€ä¸ª3ä¸ªæœˆçš„å‡è‚¥å¥èº«è®¡åˆ’ï¼Œç›®æ ‡å‡é‡10kg
```

**é¢„æœŸè¾“å‡º**ï¼š
- Planner: åŒ…å«é¥®é£Ÿã€è¿åŠ¨ã€ä¼‘æ¯çš„ç»¼åˆè®¡åˆ’
- Critic: è¯„ä¼°å¯è¡Œæ€§ï¼ŒæŒ‡å‡ºæ½œåœ¨é£Žé™©ï¼ˆè¿‡åº¦è®­ç»ƒã€è¥å…»ä¸è¶³ï¼‰
- Host: æ£€æµ‹åˆ°åˆ†æ­§ï¼Œè¦æ±‚Plannerè°ƒæ•´
- Planner: ä¼˜åŒ–è®¡åˆ’ï¼Œå¢žåŠ è¥å…»æŒ‡å¯¼å’Œæ¢å¤æœŸ
- Reporter: ç”Ÿæˆè¯¦ç»†çš„å¥èº«å‡è‚¥è®¡åˆ’

### åœºæ™¯3ï¼šè€ƒè¯•å¤‡è€ƒ

**è¾“å…¥**ï¼š
```
å¸®æˆ‘åˆ¶å®šIELTSå¤‡è€ƒè®¡åˆ’ï¼Œ3ä¸ªæœˆå†…è¾¾åˆ°7åˆ†
```

**é¢„æœŸè¾“å‡º**ï¼š
- Planner: åˆ†æ¨¡å—è®­ç»ƒï¼ˆå¬è¯´è¯»å†™ï¼‰+ æ¨¡è€ƒå®‰æŽ’
- Critic: æŒ‡å‡ºå†™ä½œè®­ç»ƒä¸è¶³ã€æ¨¡è€ƒé¢‘çŽ‡ä½Ž
- Host: æ£€æµ‹åˆ°é«˜å…±è¯†ï¼Œè¿›å…¥æ”¶æ•›é˜¶æ®µ
- Reporter: ç”Ÿæˆä¼˜åŒ–åŽçš„å¤‡è€ƒè®¡åˆ’

## ðŸ”¬ å‘é‡ç›¸ä¼¼åº¦æ£€æµ‹æŠ€æœ¯

### å·¥ä½œåŽŸç†

å¤šAgentç³»ç»Ÿä½¿ç”¨å‘é‡ç›¸ä¼¼åº¦æ¥é‡åŒ–Agentä¹‹é—´çš„ç«‹åœºå·®å¼‚ï¼š

1. **ä½ç½®æ‘˜è¦æå–**ï¼šæ¯ä¸ªAgentè¾“å‡ºåŒ…å«ä¸€ä¸ªç»“æž„åŒ–çš„ä½ç½®æ‘˜è¦ï¼ˆconclusion + key_reasons + assumptionsï¼‰

2. **æ–‡æœ¬å‘é‡åŒ–**ï¼š
   - **æ–¹æ³•Aï¼ˆæŽ¨èï¼‰**ï¼šä½¿ç”¨ç«å±±å¼•æ“Žembeddingæ¨¡åž‹å°†æ–‡æœ¬è½¬æ¢ä¸º768ç»´å‘é‡
   - **æ–¹æ³•Bï¼ˆfallbackï¼‰**ï¼šä½¿ç”¨Jaccardç›¸ä¼¼åº¦ï¼ˆåŸºäºŽå…³é”®è¯é‡å ï¼‰

3. **ç›¸ä¼¼åº¦è®¡ç®—**ï¼š
   - ä½¿ç”¨ä½™å¼¦ç›¸ä¼¼åº¦ï¼ˆCosine Similarityï¼‰è®¡ç®—å‘é‡é—´çš„å¤¹è§’
   - ç”ŸæˆNÃ—Nç›¸ä¼¼åº¦çŸ©é˜µï¼ˆNä¸ºAgentæ•°é‡ï¼‰
   - ç›¸ä¼¼åº¦èŒƒå›´ï¼š0ï¼ˆå®Œå…¨ä¸åŒï¼‰åˆ° 1ï¼ˆå®Œå…¨ç›¸åŒï¼‰

4. **å†³ç­–ä¾æ®**ï¼š
   - è®¡ç®—å¹³å‡ç›¸ä¼¼åº¦ä½œä¸ºå…±è¯†æ°´å¹³
   - æ‰¾å‡ºæœ€ä¸ç›¸ä¼¼çš„Agenté…å¯¹
   - è¿½è¸ªå…±è¯†è¶‹åŠ¿å˜åŒ–

### æŠ€æœ¯ä¼˜åŠ¿

- **ç²¾ç¡®é‡åŒ–**ï¼šå°†æŠ½è±¡çš„"ç«‹åœº"è½¬æ¢ä¸ºå¯è®¡ç®—çš„æ•°å€¼
- **è‡ªåŠ¨é™çº§**ï¼šembeddingä¸å¯ç”¨æ—¶è‡ªåŠ¨åˆ‡æ¢åˆ°ç®€å•æ–¹æ³•
- **å®žæ—¶åé¦ˆ**ï¼šæ¯è½®éƒ½é‡æ–°è®¡ç®—ï¼ŒåŠ¨æ€è°ƒæ•´ç­–ç•¥
- **å¯è§†åŒ–**ï¼šå…±è¯†è¶‹åŠ¿å›¾ç›´è§‚å±•ç¤ºè®¨è®ºè¿›å±•

### å®žçŽ°ç»†èŠ‚

```typescript
// ç›¸ä¼¼åº¦çŸ©é˜µç¤ºä¾‹ï¼ˆ3ä¸ªAgentï¼‰
[
  [1.0,  0.92, 0.88],  // Agent0ä¸Žå„Agentçš„ç›¸ä¼¼åº¦
  [0.92, 1.0,  0.81],  // Agent1ä¸Žå„Agentçš„ç›¸ä¼¼åº¦
  [0.88, 0.81, 1.0 ]   // Agent2ä¸Žå„Agentçš„ç›¸ä¼¼åº¦
]

// å¹³å‡ç›¸ä¼¼åº¦ = (0.92 + 0.88 + 0.81) / 3 = 0.87 (ä¸­ç­‰å…±è¯†)
```

## ðŸ”§ æ•…éšœæŽ’æŸ¥

### é—®é¢˜1: å¤šAgentæ¨¡å¼æ— å“åº”

**è§£å†³æ–¹æ³•**:
1. æ£€æŸ¥ `.env` æ–‡ä»¶ä¸­çš„ `ARK_API_KEY` æ˜¯å¦æ­£ç¡®
2. æŸ¥çœ‹æµè§ˆå™¨æŽ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯
3. æ£€æŸ¥åŽç«¯æ—¥å¿—ï¼ˆç»ˆç«¯è¾“å‡ºï¼‰

### é—®é¢˜2: Embedding APIä¸å¯ç”¨

**çŽ°è±¡**:
- åŽç«¯æ—¥å¿—æ˜¾ç¤º `404: doubao-embedding does not exist`
- å‡ºçŽ° "âš ï¸ [Host] Embeddingè®¡ç®—å¤±è´¥ï¼Œä½¿ç”¨ç®€å•æ–¹æ³•" è­¦å‘Š

**è§£å†³æ–¹æ³•**:
- âœ… **ç³»ç»Ÿä¼šè‡ªåŠ¨é™çº§åˆ°ç®€å•æ–‡æœ¬ç›¸ä¼¼åº¦** - åŠŸèƒ½ä¸å—å½±å“
- ç®€å•ç›¸ä¼¼åº¦åŸºäºŽå…³é”®è¯é‡å åº¦ï¼ˆJaccardç›¸ä¼¼åº¦ï¼‰ï¼Œè™½ç„¶ç²¾åº¦ç•¥ä½Žä½†è¶³å¤Ÿä½¿ç”¨
- å¦‚æžœæƒ³ä½¿ç”¨é«˜ç²¾åº¦embeddingç›¸ä¼¼åº¦ï¼š
  - æ£€æŸ¥ `ARK_EMBEDDING_API_URL` å’Œ `ARK_EMBEDDING_MODEL` é…ç½®
  - ç¡®è®¤ä½ çš„API Keyæœ‰æƒé™è®¿é—®embeddingæ¨¡åž‹
  - æˆ–è€…è”ç³»ç«å±±å¼•æ“Žå¼€é€šembeddingæ¨¡åž‹æƒé™

### é—®é¢˜3: è®¨è®ºè½®æ¬¡è¿‡å¤š

**è§£å†³æ–¹æ³•**:
- ç³»ç»Ÿä¼šè‡ªåŠ¨é™åˆ¶åœ¨5è½®ä»¥å†…
- å¦‚æžœéœ€è¦è°ƒæ•´ï¼Œä¿®æ”¹ `multiAgentOrchestrator.ts` ä¸­çš„ `maxRounds` å‚æ•°

## ðŸ“š æ›´å¤šæ–‡æ¡£

- [å®Œæ•´å®žçŽ°æ€»ç»“](./docs/MULTI_AGENT_IMPLEMENTATION_SUMMARY.md)
- [JSONåè®®è§„èŒƒ](./docs/MULTI_AGENT_PROTOCOL.md)
- [å·¥å…·è°ƒç”¨æ–‡æ¡£](./docs/TOOL_CALLING_IMPLEMENTATION.md)

## ðŸŽ‰ å¼€å§‹ä½¿ç”¨

çŽ°åœ¨ä½ å¯ä»¥å¼€å§‹ä½¿ç”¨å¤šAgentåä½œç³»ç»Ÿäº†ï¼åˆ‡æ¢åˆ° Smart AI æ¨¡å¼ï¼Œä½“éªŒæ™ºèƒ½è§„åˆ’çš„å¼ºå¤§åŠŸèƒ½ã€‚

---

**æç¤º**: å¤šAgentæ¨¡å¼ä¼šè°ƒç”¨å¤šæ¬¡æ¨¡åž‹APIï¼Œå»ºè®®ç›‘æŽ§ä½¿ç”¨é‡å’Œæˆæœ¬ã€‚


